# Cortex PRD

## Purpose

Cortex is Beluna's deliberative cognition boundary.

Boundary shape:
`[senses, physical_state(act_descriptor_catalog), cognition_state(goal-tree, l1-memory)] -> acts, cognition_state`

## Requirements

- Cortex is a pure boundary function with no direct side effects.
- Cortex does not persist state by itself; persistence belongs to Continuity.
- Cortex accepts empty `senses` on interval ticks.
- Pipeline is fixed:
  - `raw-input -> input-helpers -> <input-ir> -> primary -> <output-ir> -> output-helpers -> real-output`
- Input IR first-level XML sections:
  - `<senses>`
  - `<act-descriptor-catalog>`
  - `<instincts>`
  - `<willpower-matrix>`
  - `<focal-awareness>`
- Primary output first-level XML sections:
  - `<acts>`
  - `<willpower-matrix-patch>`
  - `<new-focal-awareness>`
  - `<is-wait-for-sense>`
- Goal model is `goal-tree`:
  - root partition: compile-time immutable string list
  - user partition: runtime mutable flat weighted forest (`GoalNode[]`) with hierarchy in `numbering`
- L1 memory model is ordered `string[]`.
- Output helper JSON contracts are direct arrays (no wrapper envelope fields).
- Output helpers consume section-local context only; full Output IR text is not required.
- `act_id` is generated by deterministic runtime code path (UUIDv7 generator), not by LLM.
- Failure policy:
  - primary failure/timeout: fail-closed noop (`acts=[]`, cognition unchanged)
  - helper failure/timeout: deterministic fallback section or empty op list

## Out of Scope

- Direct world execution.
- Queue ownership and tick scheduling.
- Ledger settlement and reservation logic.
